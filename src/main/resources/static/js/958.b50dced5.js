"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[958],{1958:function(t,e,s){s.r(e),s.d(e,{default:function(){return S}});var o=s(3396),l=s(7139),i=s(5101),c=s(6422),r=s(6824),n=s(8521),u=s(3289),a=s(4413),d=s(5869);const p=t=>((0,o.dD)("data-v-45439c0c"),t=t(),(0,o.Cn)(),t),h=p((()=>(0,o._)("div",null,[(0,o._)("span",{class:"subtitle-detail"},"공통 비용")],-1))),C=p((()=>(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{class:"text-center"},"NO."),(0,o._)("th",{class:"text-center"},"사용처"),(0,o._)("th",{class:"text-center"},"비용(원)"),(0,o._)("th",{class:"text-center"},"메모")])],-1))),m={class:"text-center"},b={class:"text-center"},g={class:"text-center"},f={class:"text-center"},w={key:0},N=p((()=>(0,o._)("td",{class:"text-center"},"합계",-1))),y=p((()=>(0,o._)("td",null,null,-1))),_={class:"text-center"};function v(t,e,s,p,v,k){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r.o,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n.D,null,{default:(0,o.w5)((()=>[h])),_:1}),v.isEditing?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(n.D,{key:0,style:{width:"80px","text-align":"right"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i.T,{onClick:k.costModify,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Uk)("비용 수정")])),_:1},8,["onClick"])])),_:1})),v.isEditing?((0,o.wg)(),(0,o.j4)(n.D,{key:1,style:{width:"80px","text-align":"right"}},{default:(0,o.w5)((()=>[(0,o.Wm)(i.T,{onClick:k.addRow,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Wm)(u.t,null,{default:(0,o.w5)((()=>[(0,o.Uk)("mdi-plus")])),_:1})])),_:1},8,["onClick"]),(0,o.Wm)(i.T,{onClick:k.removeRow,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Wm)(u.t,null,{default:(0,o.w5)((()=>[(0,o.Uk)("mdi-minus")])),_:1})])),_:1},8,["onClick"]),(0,o.Wm)(i.T,{onClick:k.costReset,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Uk)("비용 초기화")])),_:1},8,["onClick"]),(0,o.Wm)(i.T,{onClick:k.costShow,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Uk)("비용 보기")])),_:1},8,["onClick"]),(0,o.Wm)(i.T,{onClick:k.costSave,class:"button-style"},{default:(0,o.w5)((()=>[(0,o.Uk)("비용 저장")])),_:1},8,["onClick"])])),_:1})):(0,o.kq)("",!0)])),_:1}),(0,o.Wm)(r.o,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c.O,{ref:"publicForm",style:{width:"100%"},"lazy-validation":""},{default:(0,o.w5)((()=>[(0,o.Wm)(a.Y,{"fixed-header":"",height:"{{(publicCosts.length * 50) + 20}}px"},{default:(0,o.w5)((()=>[C,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(v.publicCosts,((t,e)=>((0,o.wg)(),(0,o.iD)("tr",{key:t.costOrder},[v.isEditing?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o._)("td",f,(0,l.zw)(t.costOrder),1),(0,o._)("td",null,[(0,o.Wm)(d.h,{outlined:"",class:"gray-text-field",rules:v.costUseRules,modelValue:v.publicCosts[e].costUse,"onUpdate:modelValue":t=>v.publicCosts[e].costUse=t},null,8,["rules","modelValue","onUpdate:modelValue"])]),(0,o._)("td",null,[(0,o.Wm)(d.h,{outlined:"",class:"gray-text-field",rules:v.costRules,modelValue:v.publicCosts[e].cost,"onUpdate:modelValue":t=>v.publicCosts[e].cost=t},null,8,["rules","modelValue","onUpdate:modelValue"])]),(0,o._)("td",null,[(0,o.Wm)(d.h,{outlined:"",class:"gray-text-field",rules:v.costNoteRules,modelValue:v.publicCosts[e].costNote,"onUpdate:modelValue":t=>v.publicCosts[e].costNote=t},null,8,["rules","modelValue","onUpdate:modelValue"])])],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("td",m,(0,l.zw)(t.costOrder),1),(0,o._)("td",b,(0,l.zw)(t.costUse),1),(0,o._)("td",g,(0,l.zw)(t.cost.toLocaleString()),1),(0,o._)("td",null,(0,l.zw)(t.costNote),1)],64))])))),128)),v.publicCosts.length>0?((0,o.wg)(),(0,o.iD)("tr",w,[N,y,(0,o._)("td",_,[(0,o._)("strong",null,(0,l.zw)(v.publicCostSum),1)])])):(0,o.kq)("",!0)])])),_:1},8,["height"])])),_:1},512)])),_:1})],64)}s(7658);var k={components:{},created(){this.tripProjectNo=sessionStorage.getItem("projectNoSession"),this.tripUserNo=sessionStorage.getItem("userNoSession"),console.log("projectNoSession",sessionStorage.getItem("projectNoSession")),console.log("userNoSession",sessionStorage.getItem("userNoSession"))},mounted(){this.costShow()},data(){return{isEditing:!1,publicCosts:[],publicCostSum:0,costUseRules:[t=>!(t&&t.length>10)||"사용처 입력은 최대 10글자까지 가능합니다.( "+t.length+"글자 )"],costRules:[t=>/^[0-9]*$/.test(t)||"숫자만 입력 가능합니다."],costNoteRules:[t=>!(t&&t.length>30)||"메모 입력은 최대 30글자까지 가능합니다.( "+t.length+"글자 )"],tripSaveCost:[],tripUdpateCost:[],tripDeleteCost:[]}},methods:{costShow(){const t={tripProjectNo:this.tripProjectNo};this.$axios.get("/trip/cost/public/info/list",{params:t}).then((t=>{console.log("costShow",t);let e=0;this.publicCosts=t.data.map((t=>(e+=parseInt(t.tripPublicCost),{costNo:t.tripPublicCostNo,costOrder:t.tripPublicCostOrder,costUse:t.tripPublicCostUse,cost:t.tripPublicCost,costNote:t.tripPublicCostNote}))),this.publicCostSum=e.toLocaleString()})).catch((t=>{console.log(t)})).finally((()=>{this.isEditing=!1}))},costModify(){this.isEditing=!0},async deleteCost(){try{console.log("this.tripDeleteCost",this.tripDeleteCost),await this.$axios.delete("/trip/cost/public/info",{data:this.tripDeleteCost}),console.log("Delete request completed.")}catch(t){console.log("Error during delete request:",t)}finally{this.tripDeleteCost=[],this.costShow()}},async updateCost(){try{await this.$axios.put("/trip/cost/public/info/list",this.tripUdpateCost),console.log("Update request completed.")}catch(t){console.log("Error during update request:",t)}finally{this.tripUdpateCost=[],this.costShow()}},async saveCost(){try{await this.$axios.post("/trip/cost/public/info",this.tripSaveCost),console.log("Save request completed.")}catch(t){console.log("Error during save request:",t)}finally{this.tripSaveCost=[],this.costShow()}},async executeRequests(){await this.deleteCost(),await this.updateCost(),await this.saveCost()},async costSave(){let t="";await this.$refs.publicForm.validate().then((e=>{e.valid&&(this.publicCosts.forEach((e=>{t=""!=e.costOrder?e.costOrder:"",console.log("tripPublicCostOrder",t),console.log("e.cost",e.cost),""!=t?this.tripUdpateCost.push({tripProjectNo:this.tripProjectNo,tripPublicCost:{tripPublicCostNo:e.costNo,tripPublicCostOrder:t,tripPublicCostUse:e.costUse,tripPublicCost:e.cost,tripPublicCostNote:e.costNote}}):this.tripSaveCost.push({tripProjectNo:this.tripProjectNo,tripPublicCost:{tripPublicCostNo:e.costNo,tripPublicCostUse:e.costUse,tripPublicCost:e.cost,tripPublicCostNote:e.costNote}})})),this.executeRequests(),this.isEditing=!1)}))},costReset(){this.publicCosts=[]},addRow(){console.log("add row 왜 안보여?"),this.publicCosts.push({costNo:"",costOrder:"",costUse:"",cost:"",costNote:""})},removeRow(){if(console.log("remove row 왜 안보여?"),this.publicCosts.length>0){const t=this.publicCosts.slice(-1)[0],e=t.costOrder;""!=e&&(this.tripDeleteCost.push({tripProjectNo:this.tripProjectNo,tripPublicCostNo:t.costNo,tripPublicCostOrder:e}),console.log("this.tripDeleteCost",this.tripDeleteCost)),this.publicCosts.pop()}}}},U=s(89);const P=(0,U.Z)(k,[["render",v],["__scopeId","data-v-45439c0c"]]);var S=P},6422:function(t,e,s){s.d(e,{O:function(){return p}});var o=s(3396),l=s(9166),i=s(4357),c=s(3185),r=s(4870),n=s(3766),u=s(1107),a=s(9888);const d=(0,n.U)({...(0,l.l)(),...(0,i.vC)()},"VForm"),p=(0,u.ev)()({name:"VForm",props:d(),emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,e){let{slots:s,emit:l}=e;const n=(0,i.Np)(t),u=(0,r.iH)();function d(t){t.preventDefault(),n.reset()}function p(t){const e=t,s=n.validate();e.then=s.then.bind(s),e.catch=s.catch.bind(s),e.finally=s.finally.bind(s),l("submit",e),e.defaultPrevented||s.then((t=>{let{valid:e}=t;e&&u.value?.submit()})),e.preventDefault()}return(0,a.L)((()=>(0,o.Wm)("form",{ref:u,class:["v-form",t.class],style:t.style,novalidate:!0,onReset:d,onSubmit:p},[s.default?.(n)]))),(0,c.F)(n,u)}})}}]);
//# sourceMappingURL=958.b50dced5.js.map