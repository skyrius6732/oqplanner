"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[476,864],{4827:function(t,e,o){o.r(e),o.d(e,{default:function(){return U}});var s=o(3396),i=o(9242),l=o(5101),a=o(9752),n=o(6572),c=o(1888),r=o(1334),u=o(3601),p=o(4075),d=o(6422),m=o(3369),h=o(6824),b=o(8521),C=o(9234),f=o(4039),g=o(9671),w=o(5869);const v=t=>((0,s.dD)("data-v-7ed7eb26"),t=t(),(0,s.Cn)(),t),y=v((()=>(0,s._)("div",{class:"overlay"},[(0,s._)("span",{class:"no-results-text"},"적용 버튼을 눌러 여행 비용을 등록 해주세요.")],-1)));function N(t,e,o,v,N,k){const _=(0,s.up)("TripPublicCost"),V=(0,s.up)("TripPrivateCost"),P=(0,s.up)("TripPrivateCostDetail");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(m.K,{class:"custom-container"},{default:(0,s.w5)((()=>[(0,s.Wm)(d.O,{ref:"form","lazy-validation":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h.o,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b.D,{class:"m-1"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.o,null,{default:(0,s.w5)((()=>[(0,s.Wm)(f.rL,{modelValue:N.numberOfCompanions,"onUpdate:modelValue":[e[0]||(e[0]=t=>N.numberOfCompanions=t),k.clickComNumber],items:[0,1,2,3,4],label:"여행 인원을 선택 해주세요(본인 포함)",disabled:N.companionNumDisabled,class:"margin-right"},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,s.Wm)(g.v,{modelValue:N.snackbar,"onUpdate:modelValue":e[1]||(e[1]=t=>N.snackbar=t),timeout:"3000",class:"snackbar-center",flex:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" 여행자 수는 한번 적용 후 변경이 불가하오니 참고 부탁드립니다. ")])),_:1},8,["modelValue"])])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(N.companions,((t,e)=>((0,s.wg)(),(0,s.j4)(b.D,{key:e,class:"m-1"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.o,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w.h,{outlined:"",class:"gray-text-field margin-right",label:`여행자 ${e+1}`,rules:N.companionNameRules,disabled:N.companionNmDisabled,modelValue:t.tripCompanionNm,"onUpdate:modelValue":e=>t.tripCompanionNm=e,onKeyup:(0,i.D2)(k.companionApply,["enter"])},null,8,["label","rules","disabled","modelValue","onUpdate:modelValue","onKeyup"])])),_:2},1024)])),_:2},1024)))),128)),(0,s.Wm)(b.D,{class:"m-4"},{default:(0,s.w5)((()=>[N.companionEdit?((0,s.wg)(),(0,s.j4)(h.o,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:k.companionApply,size:"x-large",class:"apply-button-style center-button"},{default:(0,s.w5)((()=>[(0,s.Uk)("적용")])),_:1},8,["onClick"])])),_:1})):((0,s.wg)(),(0,s.j4)(h.o,{key:1},{default:(0,s.w5)((()=>[0!=N.numberOfCompanions?((0,s.wg)(),(0,s.j4)(l.T,{key:0,onClick:k.companionModify,size:"x-large",class:"apply-button-style center-button"},{default:(0,s.w5)((()=>[(0,s.Uk)("여행자 수정")])),_:1},8,["onClick"])):(0,s.kq)("",!0),(0,s.Wm)(l.T,{onClick:k.startShowResetDialog,size:"x-large",class:"apply-button-style center-button"},{default:(0,s.w5)((()=>[(0,s.Uk)("전체 초기화")])),_:1},8,["onClick"])])),_:1}))])),_:1})])),_:1})])),_:1},512),(0,s.Wm)(h.o,{class:"underline-row"},{default:(0,s.w5)((()=>[(0,s.Wm)(b.D,null,{default:(0,s.w5)((()=>[(0,s.Wm)(p.J)])),_:1})])),_:1}),N.isOverlayVisible?((0,s.wg)(),(0,s.j4)(h.o,{key:0,onClick:k.hideOverlay},{default:(0,s.w5)((()=>[y])),_:1},8,["onClick"])):(0,s.kq)("",!0),N.isCostVisible?((0,s.wg)(),(0,s.j4)(_,{key:1})):(0,s.kq)("",!0),N.isCostVisible?((0,s.wg)(),(0,s.j4)(V,{key:2,companions:N.companions,ref:"privateCostMethod",onViewCost:k.viewCost},null,8,["companions","onViewCost"])):(0,s.kq)("",!0),(0,s.Wm)(P,{modelValue:N.isModalVisible,"onUpdate:modelValue":e[2]||(e[2]=t=>N.isModalVisible=t),onCloseDialog:k.closeDialog},null,8,["modelValue","onCloseDialog"])])),_:1}),(0,s.Wm)(u.B,{modelValue:N.resetDialog,"onUpdate:modelValue":e[4]||(e[4]=t=>N.resetDialog=t),persistent:"",width:"auto"},{default:(0,s.w5)((()=>[(0,s.Wm)(a._,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n.E,{class:"text-h5"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 여행 비용 전체 초기화 하시겠습니까? ")])),_:1}),(0,s.Wm)(c.Z,null,{default:(0,s.w5)((()=>[(0,s.Uk)("등록 하신 여행자, 여행 공통비용, 여행 개인비용이 모두 삭제 됩니다.")])),_:1}),(0,s.Wm)(r.h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C.C),(0,s.Wm)(l.T,{variant:"text",onClick:e[3]||(e[3]=t=>N.resetDialog=!1),class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 취소 ")])),_:1}),(0,s.Wm)(l.T,{variant:"text",onClick:k.startReset,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)(" 확인 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var k=o(6990),_=o(1958),V=o(6129),P={components:{TripPrivateCostDetail:k["default"],TripPublicCost:_["default"],TripPrivateCost:V["default"]},created(){this.tripProjectNo=sessionStorage.getItem("projectNoSession"),this.tripUserNo=sessionStorage.getItem("userNoSession"),console.log("projectNoSession",sessionStorage.getItem("projectNoSession")),console.log("userNoSession",sessionStorage.getItem("userNoSession")),console.log(this.tripProjectNo),console.log(this.tripUserNo)},mounted(){this.companionSelect()},data(){return{resetDialog:!1,snackbar:!1,companionExistFlag:!1,isModalVisible:!1,isCostVisible:!1,tripProjectNo:"",tripUserNo:"",numberOfCompanions:0,companions:Array.from({length:3},(()=>({tripProjectNo:"",tripCompanionNm:"",tripCompanionOrder:""}))),isOverlayVisible:!0,companionNmDisabled:!1,companionNumDisabled:!1,companionEdit:!0,companionNameRules:[t=>!!t||"여행자 이름은 필수사항 입니다.",t=>/^[가-힣a-zA-Z\s]*$/.test(t)||"여행자 이름은 한글/영어만 입력 가능합니다.",t=>!(t&&t.length>8)||"여행자 이름은 8자 이상 입력할 수 없습니다."]}},methods:{startShowResetDialog(){this.resetDialog=!0},startReset(){this.resetDialog=!1,this.allReset()},companionSelect(){const t={tripProjectNo:this.tripProjectNo};this.$axios.get("/trip/companion/info/list",{params:t}).then((t=>{let e=t.data.length;this.companionExistFlag=e>0,this.companions=t.data,this.numberOfCompanions=e,console.log("companionSelect response",t)})).catch((t=>{console.log(t)})).finally((()=>{this.companionExistFlag?this.companionNumDisabled=!0:this.companionNumDisabled=!1}))},async companionApply(){const t=await this.$refs.form.validate();if(t.valid){const t=this.companions.map((t=>(console.log("item",t),{tripProjectNo:this.tripProjectNo,tripCompanionNm:t.tripCompanionNm,tripCompanionOrder:t.tripCompanionOrder})));if(0==this.companionExistFlag){console.log("여행자 신규 저장");for(const t of this.companions){console.log("저장시 this.companions element",t);const o={...t,tripProjectNo:this.tripProjectNo};console.log("저장시 this.companions element",o);try{const e=await this.$axios.post("/trip/companion/info",o);console.log("new companion",e.data);const s={...o,tripCompanionNo:e.data};this.companions=this.companions.map((e=>e===t?s:e))}catch(e){console.log(e)}}}else{console.log("여행자 기존 수정");try{const e=await this.$axios.put("/trip/companion/info/list",t);console.log(e)}catch(e){console.log(e)}}this.isCostVisible=!0,this.companionNumDisabled=!0,this.companionNmDisabled=!0,this.isOverlayVisible=!1,this.companionEdit=!1}this.$nextTick((()=>{}))},companionModify(){this.isCostVisible=!1,this.companionNmDisabled=!1,this.isOverlayVisible=!0,this.companionEdit=!0},companionReset(){this.isCostVisible=!1,this.companionNmDisabled=!1,this.companionNumDisabled=!1,this.isOverlayVisible=!0,this.companionEdit=!0,this.numberOfCompanions=0,this.companions=[]},clickComNumber(){this.snackbar=!0,this.companions=Array.from({length:this.numberOfCompanions},(()=>({tripProjectNo:"",tripCompanionNm:"",tripCompanionOrder:""})))},hideOverlay(){},viewCost(t){console.log("Received index from TripPrivateCost:",t),console.log("viewCost isModalVisible",this.isModalVisible),this.isModalVisible=!0},allReset(){let t={tripProjectNo:this.tripProjectNo};this.$axios.delete("/trip/cost/info/all",{data:t}).then((()=>this.$axios.delete("/trip/companion/info",t))).then((()=>{})).catch((()=>{})).finally((()=>{this.companionReset()}))},closeDialog(){this.$refs.privateCostMethod.costShow(),this.isModalVisible=!1}}},D=o(89);const S=(0,D.Z)(P,[["render",N],["__scopeId","data-v-7ed7eb26"]]);var U=S},1958:function(t,e,o){o.r(e),o.d(e,{default:function(){return D}});var s=o(3396),i=o(7139),l=o(5101),a=o(6422),n=o(6824),c=o(8521),r=o(3289),u=o(4413),p=o(5869);const d=t=>((0,s.dD)("data-v-45439c0c"),t=t(),(0,s.Cn)(),t),m=d((()=>(0,s._)("div",null,[(0,s._)("span",{class:"subtitle-detail"},"공통 비용")],-1))),h=d((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{class:"text-center"},"NO."),(0,s._)("th",{class:"text-center"},"사용처"),(0,s._)("th",{class:"text-center"},"비용(원)"),(0,s._)("th",{class:"text-center"},"메모")])],-1))),b={class:"text-center"},C={class:"text-center"},f={class:"text-center"},g={class:"text-center"},w={key:0},v=d((()=>(0,s._)("td",{class:"text-center"},"합계",-1))),y=d((()=>(0,s._)("td",null,null,-1))),N={class:"text-center"};function k(t,e,o,d,k,_){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(n.o,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c.D,null,{default:(0,s.w5)((()=>[m])),_:1}),k.isEditing?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(c.D,{key:0,style:{width:"80px","text-align":"right"}},{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:_.costModify,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)("비용 수정")])),_:1},8,["onClick"])])),_:1})),k.isEditing?((0,s.wg)(),(0,s.j4)(c.D,{key:1,style:{width:"80px","text-align":"right"}},{default:(0,s.w5)((()=>[(0,s.Wm)(l.T,{onClick:_.addRow,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Wm)(r.t,null,{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-plus")])),_:1})])),_:1},8,["onClick"]),(0,s.Wm)(l.T,{onClick:_.removeRow,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Wm)(r.t,null,{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-minus")])),_:1})])),_:1},8,["onClick"]),(0,s.Wm)(l.T,{onClick:_.costReset,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)("비용 초기화")])),_:1},8,["onClick"]),(0,s.Wm)(l.T,{onClick:_.costShow,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)("비용 보기")])),_:1},8,["onClick"]),(0,s.Wm)(l.T,{onClick:_.costSave,class:"button-style"},{default:(0,s.w5)((()=>[(0,s.Uk)("비용 저장")])),_:1},8,["onClick"])])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(n.o,null,{default:(0,s.w5)((()=>[(0,s.Wm)(a.O,{ref:"publicForm",style:{width:"100%"},"lazy-validation":""},{default:(0,s.w5)((()=>[(0,s.Wm)(u.Y,{"fixed-header":"",height:"{{(publicCosts.length * 50) + 20}}px"},{default:(0,s.w5)((()=>[h,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.publicCosts,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:t.costOrder},[k.isEditing?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s._)("td",g,(0,i.zw)(t.costOrder),1),(0,s._)("td",null,[(0,s.Wm)(p.h,{outlined:"",class:"gray-text-field",rules:k.costUseRules,modelValue:k.publicCosts[e].costUse,"onUpdate:modelValue":t=>k.publicCosts[e].costUse=t},null,8,["rules","modelValue","onUpdate:modelValue"])]),(0,s._)("td",null,[(0,s.Wm)(p.h,{outlined:"",class:"gray-text-field",rules:k.costRules,modelValue:k.publicCosts[e].cost,"onUpdate:modelValue":t=>k.publicCosts[e].cost=t},null,8,["rules","modelValue","onUpdate:modelValue"])]),(0,s._)("td",null,[(0,s.Wm)(p.h,{outlined:"",class:"gray-text-field",rules:k.costNoteRules,modelValue:k.publicCosts[e].costNote,"onUpdate:modelValue":t=>k.publicCosts[e].costNote=t},null,8,["rules","modelValue","onUpdate:modelValue"])])],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("td",b,(0,i.zw)(t.costOrder),1),(0,s._)("td",C,(0,i.zw)(t.costUse),1),(0,s._)("td",f,(0,i.zw)(t.cost.toLocaleString()),1),(0,s._)("td",null,(0,i.zw)(t.costNote),1)],64))])))),128)),k.publicCosts.length>0?((0,s.wg)(),(0,s.iD)("tr",w,[v,y,(0,s._)("td",N,[(0,s._)("strong",null,(0,i.zw)(k.publicCostSum),1)])])):(0,s.kq)("",!0)])])),_:1},8,["height"])])),_:1},512)])),_:1})],64)}o(7658);var _={components:{},created(){this.tripProjectNo=sessionStorage.getItem("projectNoSession"),this.tripUserNo=sessionStorage.getItem("userNoSession"),console.log("projectNoSession",sessionStorage.getItem("projectNoSession")),console.log("userNoSession",sessionStorage.getItem("userNoSession"))},mounted(){this.costShow()},data(){return{isEditing:!1,publicCosts:[],publicCostSum:0,costUseRules:[t=>!(t&&t.length>10)||"사용처 입력은 최대 10글자까지 가능합니다.( "+t.length+"글자 )"],costRules:[t=>/^[0-9]*$/.test(t)||"숫자만 입력 가능합니다."],costNoteRules:[t=>!(t&&t.length>30)||"메모 입력은 최대 30글자까지 가능합니다.( "+t.length+"글자 )"],tripSaveCost:[],tripUdpateCost:[],tripDeleteCost:[]}},methods:{costShow(){const t={tripProjectNo:this.tripProjectNo};this.$axios.get("/trip/cost/public/info/list",{params:t}).then((t=>{console.log("costShow",t);let e=0;this.publicCosts=t.data.map((t=>(e+=parseInt(t.tripPublicCost),{costNo:t.tripPublicCostNo,costOrder:t.tripPublicCostOrder,costUse:t.tripPublicCostUse,cost:t.tripPublicCost,costNote:t.tripPublicCostNote}))),this.publicCostSum=e.toLocaleString()})).catch((t=>{console.log(t)})).finally((()=>{this.isEditing=!1}))},costModify(){this.isEditing=!0},async deleteCost(){try{console.log("this.tripDeleteCost",this.tripDeleteCost),await this.$axios.delete("/trip/cost/public/info",{data:this.tripDeleteCost}),console.log("Delete request completed.")}catch(t){console.log("Error during delete request:",t)}finally{this.tripDeleteCost=[],this.costShow()}},async updateCost(){try{await this.$axios.put("/trip/cost/public/info/list",this.tripUdpateCost),console.log("Update request completed.")}catch(t){console.log("Error during update request:",t)}finally{this.tripUdpateCost=[],this.costShow()}},async saveCost(){try{await this.$axios.post("/trip/cost/public/info",this.tripSaveCost),console.log("Save request completed.")}catch(t){console.log("Error during save request:",t)}finally{this.tripSaveCost=[],this.costShow()}},async executeRequests(){await this.deleteCost(),await this.updateCost(),await this.saveCost()},async costSave(){let t="";await this.$refs.publicForm.validate().then((e=>{e.valid&&(this.publicCosts.forEach((e=>{t=""!=e.costOrder?e.costOrder:"",console.log("tripPublicCostOrder",t),console.log("e.cost",e.cost),""!=t?this.tripUdpateCost.push({tripProjectNo:this.tripProjectNo,tripPublicCost:{tripPublicCostNo:e.costNo,tripPublicCostOrder:t,tripPublicCostUse:e.costUse,tripPublicCost:e.cost,tripPublicCostNote:e.costNote}}):this.tripSaveCost.push({tripProjectNo:this.tripProjectNo,tripPublicCost:{tripPublicCostNo:e.costNo,tripPublicCostUse:e.costUse,tripPublicCost:e.cost,tripPublicCostNote:e.costNote}})})),this.executeRequests(),this.isEditing=!1)}))},costReset(){this.publicCosts=[]},addRow(){console.log("add row 왜 안보여?"),this.publicCosts.push({costNo:"",costOrder:"",costUse:"",cost:"",costNote:""})},removeRow(){if(console.log("remove row 왜 안보여?"),this.publicCosts.length>0){const t=this.publicCosts.slice(-1)[0],e=t.costOrder;""!=e&&(this.tripDeleteCost.push({tripProjectNo:this.tripProjectNo,tripPublicCostNo:t.costNo,tripPublicCostOrder:e}),console.log("this.tripDeleteCost",this.tripDeleteCost)),this.publicCosts.pop()}}}},V=o(89);const P=(0,V.Z)(_,[["render",k],["__scopeId","data-v-45439c0c"]]);var D=P},6422:function(t,e,o){o.d(e,{O:function(){return d}});var s=o(3396),i=o(9166),l=o(4357),a=o(3185),n=o(4870),c=o(3766),r=o(1107),u=o(9888);const p=(0,c.U)({...(0,i.l)(),...(0,l.vC)()},"VForm"),d=(0,r.ev)()({name:"VForm",props:p(),emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,e){let{slots:o,emit:i}=e;const c=(0,l.Np)(t),r=(0,n.iH)();function p(t){t.preventDefault(),c.reset()}function d(t){const e=t,o=c.validate();e.then=o.then.bind(o),e.catch=o.catch.bind(o),e.finally=o.finally.bind(o),i("submit",e),e.defaultPrevented||o.then((t=>{let{valid:e}=t;e&&r.value?.submit()})),e.preventDefault()}return(0,u.L)((()=>(0,s.Wm)("form",{ref:r,class:["v-form",t.class],style:t.style,novalidate:!0,onReset:p,onSubmit:d},[o.default?.(c)]))),(0,a.F)(c,r)}})},9671:function(t,e,o){o.d(e,{v:function(){return v}});var s=o(3396),i=o(836),l=o(292),a=o(3185),n=o(5180),c=o(489),r=o(8717),u=o(4231),p=o(5975),d=o(5935),m=o(5221),h=o(4870),b=o(3766),C=o(131),f=o(1107),g=o(9888);const w=(0,b.U)({multiLine:Boolean,timeout:{type:[Number,String],default:5e3},vertical:Boolean,...(0,n.y)({location:"bottom"}),...(0,c.F)(),...(0,u.I)(),...(0,m.bk)(),...(0,d.x$)(),...(0,C.CE)((0,l.B)({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),v=(0,f.ev)()({name:"VSnackbar",props:w(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:o}=e;const b=(0,r.z)(t,"modelValue"),{locationStyles:C}=(0,n.T)(t),{positionClasses:f}=(0,c.K)(t),{scopeId:w}=(0,p.a)(),{themeClasses:v}=(0,d.ER)(t),{colorClasses:y,colorStyles:N,variantClasses:k}=(0,m.c1)(t),{roundedClasses:_}=(0,u.b)(t),V=(0,h.iH)();(0,s.YP)(b,D),(0,s.YP)((()=>t.timeout),D),(0,s.bv)((()=>{b.value&&D()}));let P=-1;function D(){window.clearTimeout(P);const e=Number(t.timeout);b.value&&-1!==e&&(P=window.setTimeout((()=>{b.value=!1}),e))}function S(){window.clearTimeout(P)}return(0,g.L)((()=>{const[e]=l.y.filterProps(t);return(0,s.Wm)(l.y,(0,s.dG)({ref:V,class:["v-snackbar",{"v-snackbar--active":b.value,"v-snackbar--multi-line":t.multiLine&&!t.vertical,"v-snackbar--vertical":t.vertical},f.value,t.class],style:t.style},e,{modelValue:b.value,"onUpdate:modelValue":t=>b.value=t,contentProps:(0,s.dG)({class:["v-snackbar__wrapper",v.value,y.value,_.value,k.value],style:[C.value,N.value],onPointerenter:S,onPointerleave:D},e.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},w),{default:()=>[(0,m.Ux)(!1,"v-snackbar"),o.default&&(0,s.Wm)("div",{class:"v-snackbar__content",role:"status","aria-live":"polite"},[o.default()]),o.actions&&(0,s.Wm)(i.z,{defaults:{VBtn:{variant:"text",ripple:!1}}},{default:()=>[(0,s.Wm)("div",{class:"v-snackbar__actions"},[o.actions()])]})],activator:o.activator})})),(0,a.F)({},V)}})}}]);
//# sourceMappingURL=476.c73e1319.js.map